{% extends "base.html" %}

{% block title %}Cadastro{% endblock %}

{% block content %}
    <style>
        .table-responsive{
                max-height: 630px; 
                overflow-y: auto; 
            }

        th, td{
            vertical-align: middle;
        }

        a{
            text-decoration: none;
        }

        .button{
            border: 2px solid #000;
            padding: 4px 7px;
            border-radius: 5px;

            min-width: 147px;

            text-align: center;

            color: #000;

            align-self: center;

            transition: 0.2s;
        }

        .button:hover{
            transform: translateY(-1px);
        }

    </style>
<form method="get" class="mb-3">
    <div class="row g-2">

        <!-- Campo de busca por nome -->
        <div class="col-md-5">
            <input type="text" name="nome" class="form-control" 
                   placeholder="Pesquisar produto..." 
                   value="{{ request.GET.nome }}">
        </div>

        <!-- Filtro por ação -->
        <div class="col-md-3">
            <select name="acao" class="form-control">
                <option value="">Todas as ações</option>
                {% for valor, descricao in acoes_disponiveis %}
                    <option value="{{ valor }}" {% if request.GET.acao == valor %}selected{% endif %}>
                        {{ descricao }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <!-- Filtro por data -->
        <div class="col-md-2">
            <input type="date" name="data" class="form-control" value="{{ request.GET.data }}">
        </div>

        <!-- Botão Filtrar -->
        <div class="col-md-1">
            <button class="btn btn-warning w-100">Filtrar</button>
        </div>

        <!-- Botão Limpar -->
        <div class="col-md-1">
            <a href="{% url 'historico' %}" class="btn btn-outline-secondary w-100">Limpar</a>
        </div>

    </div>
</form>
<div class="table-responsive mt-3">
    <table class="table table-bordered text-center">
        <thead>
            <th>Id_Usuario</th>
            <th>Nome do Produto</th>
            <th>Ação Realizada</th>
            <th>Data/Hora</th>
        </thead>

        {% for obj_historico in historico %}
        <tr>
            <td>{{ obj_historico.id_usuario }}</td>
            <td>{{ obj_historico.nome_produto }}</td>
            <td>{{ obj_historico.acao }}</td>
            <td>{{ obj_historico.data_hora_formatada }}</td>
        </tr>
        {% endfor %}
    </table>
</div>
<div class="d-flex justify-content-center mt-2">
    <a class="button" href="{% url 'produtos_estoque' %}">Estoque</a>
</div>
{% endblock content %}